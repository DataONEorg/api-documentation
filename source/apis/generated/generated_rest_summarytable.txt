.. list-table:: REST URLs implemented on Member Nodes.
   :widths: 10 10 30
   :header-rows: 1

   * - Path
     - Method
     - Description
   * - GET /monitor/ping
     - :func:`MN_core.ping`
     - Low level "are you alive" operation. A valid ping response is indicated
       by a HTTP status of 200.  The Member Node should perform some minimal
       internal functionality testing before answering. However, ping checks
       will be frequent (every few minutes) so the internal functionality test
       should not be high impact.
   * - GET /log
     - :func:`MN_core.getLogRecords`
     - Retrieve log information from the Member Node for the specified date
       range and even type. This method is used primarily by the log aggregator
       to generate aggregate statistics for nodes, objects, and the methods of
       access.
   * - GET /monitor/object
     - :func:`MN_core.getObjectStatistics`
     - Returns the number of objects stored on the Member Node at the time the
       call is serviced. The count may be restricted to a particular object
       format or a filter on the PID. Access control rules are not applied to
       the count, so the actual record count may differ from the number of
       records that are accessible through other calls such as
       :func:`MN.listObjects`, however the response *must* be indicative of the
       number of objects available through the DataONE service interfaces. ..
       Note:: Functionality of this method has been simplfiied from the 0.5
       description so that the response reflects the current state of the Member
       Node. Historical information should be collated by a monitoring service
       if necessary. This change was made to reduce the operational requirements
       for Member Node services.
   * - GET /monitor/event
     - :func:`MN_core.getOperationStatistics`
     - Returns the number of operations that have been serviced by the node over
       time periods of one and 24 hours. .. Note:: Functionality of this method
       has been simplfiied from the 0.5 description so that the response
       reflects the current state of the Member Node. Historical information
       should be collated by a monitoring service if necessary. This change was
       made to reduce the operational requirements for Member Node services.
   * - GET /monitor/status
     - :func:`MN_core.getStatus`
     - This function is similar to :func:`MN_health.ping` but returns a more
       complete status which may include information such as planned service
       outages. This method provide a mechanism for notification to Coordinating
       Nodes at a higher frequency than through setting properties in the node
       registry information. The response to a *getStatus* request is currently
       undefined, but will be a structure containing information that can be
       used by the Coordinating Nodes for notification of pending outages,
       software changes, or other significant events as described in
       :doc:`/design/UseCases/10_uc`.
   * - GET /  or  GET /node
     - :func:`MN_core.getCapabilities`
     - Returns a document describing the capabilities of the Member Node.
   * - GET /object/{pid}
     - :func:`MN_read.get`
     - Retrieve an object identified by *pid* from the node. The response must
       contain the bytes of the indicated object, and the checksum of the bytes
       retrieved must match the :attr:`SystemMetadata.checksum` recorded in the
       :class:`Types.SystemMetadata` if the object is science data. If the
       object does not exist on the node servicing the request, then
       :exc:`Exceptions.NotFound` must be raised even if the object exists on
       another node in the DataONE system. Also implmented by Coordinating Nodes
       as :func:`CN_crud.get`.
   * - GET /meta/{pid}
     - :func:`MN_read.getSystemMetadata`
     - Describes the science metadata or data object (and likely other objects
       in the future) identified by *pid* by returning the associated system
       metadata object. If the object does not exist on the node servicing the
       request, then :exc:`Exceptions.NotFound` must be raised even if the
       object exists on another node in the DataONE system.
   * - HEAD /object/{pid}
     - :func:`MN_read.describe`
     - This method provides a lighter weight mechanism than
       :func:`MN_read.getSystemMetadata` for a client to determine basic
       properties of the referenced object. The response should indicate
       properties that are typically returned in a HTTP HEAD request: the date
       late modified, the size of the object, the type of the object (the
       :attr:`SystemMetadata.objectFormat`). The principal indicated by *token*
       must have read privileges on the object, otherwise
       :exc:`Exceptions.NotAuthorized` is raised. If the object does not exist
       on the node servicing the request, then :exc:`Exceptions.NotFound` must
       be raised even if the object exists on another node in the DataONE
       system.  Note that this method is likely to be called frequently and so
       efficiency should be taken into consideratin during implementation.
   * - GET /checksum/{pid}
     - :func:`MN_read.getChecksum`
     - Returns a :class:`Types.Checksum` for the specified object using an
       accepted hashing algorithm. The result is used to determine if two
       instances referenced by a PID are identical, hence it is necessary that
       MNs can ensure that the returned checksum is valid for the referenced
       object either by computing it on the fly or by using a cached value that
       is certain to be correct.
   * - GET /object
     - :func:`MN_read.listObjects`
     - Retrieve the list of objects present on the MN that match the calling
       parameters. This method is required to support the process of
       :term:`Member Node synchronization`. At a minimum, this method should be
       able to return a list of objects that match::      startTime <=
       SystemMetadata.dateSysMetadataModified    but is expected to also support
       date range (by also specifying *endTime*), and should also support
       slicing of the matching set of records by indicating the starting *index*
       of the response (where 0 is the index of the first item) and the *count*
       of elements to be returned.
   * - POST /error
     - :func:`MN_read.synchronizationFailed`
     - This is a callback method used by a CN to indicate to a MN that it cannot
       complete synchronization of the science metadata identified by *pid*.
       When called, the MN should take steps to record the problem description
       and notify an administrator or the data owner of the issue.
   * - GET /isAuthorized/{pid}
     - :func:`MN_auth.isAuthorized`
     - Test if the user identified by the provided token has authorization for
       operation on the specified object. .. Note:: Should perhaps add
       convenience methods for "canRead()" and "canWrite()" to verify that a
       user is able to read / write an object.
   * - PUT /accessRules/{pid}
     - :func:`MN_auth.setAccess`
     - Sets the access permissions for an object identified by *pid*.
   * - POST /object/{pid}
     - :func:`MN_storage.create`
     - Adds a new object to the Member Node, where the object is either a data
       object or a science metadata object. This method is called by clients to
       create new data objects on Member Nodes.  The *pid* must not exist in the
       DataONE system or must have been previously reserved using
       :func:`CN_crud.reserveIdentifier`.
   * - PUT /object/{pid}
     - :func:`MN_storage.update`
     - Updates an existing object by creating a new object identified by
       *newPid* on the Member Node which explicitly obsoletes the object
       identified by *pid* through appropriate changes to the SystemMetadata of
       *pid* and *newPid*.  This method is called by clients to update objects
       on Member Nodes.  The *pid* of the object being obsoleted is passed in as
       a parameter, and the Member Node should record the update by storing the
       :attr:`SystemMetadata.obsoletes` and :attr:`SystemMetadata.obsoletedBy`
       fields for the respective objects in their system metadata. The modified
       system metadata entries must then be available in
       :func:`MN_read.listObjects` to ensure that a Coordinating Node will pick
       up the changes when filtering on
       :attr:`SystmeMetadata.dateSysMetadataModified`.
   * - DELETE /object/{pid}
     - :func:`MN_storage.delete`
     - Deletes an object from the Member Node, where the object is either a data
       object or a science metadata object. This method is called by clients to
       delete objects on Member nodes. Member Nodes must check that the caller
       is authorized to perform this function. If the object does not exist on
       the node servicing the request, then an :exc:`Exceptions.NotFound`
       exception is raised. The message body of the exception should contain a
       hint as to the location of the :func:`CN_crud.resolve` method.
   * - POST /replicate
     - :func:`MN_replication.replicate`
     - Called by a Coordinating Node to request that the Member Node create a
       copy of the specified object by retrieving it from another Member Nodeode
       and storing it locally so that it can be made accessible to the DataONE
       system.


.. list-table:: REST URLs implemented on Coordinating Nodes.
   :widths: 10 10 30
   :header-rows: 1

   * - Path
     - Method
     - Description
   * - GET /object/{pid}
     - :func:`CN_read.get`
     - Retrieves the object identified by *pid* from the node. If the object is
       not present on the node, then an :exc:`Exceptions.NotFound` error is
       raised (regardless of whether the object exists on another node in the
       DataONE system).
   * - GET /meta/{pid}
     - :func:`CN_read.getSystemMetadata`
     - Returns the :term:`system metadata` that contains DataONE specific
       information about the object identified by *pid*. Note that authoritative
       copies of system metadata are only available from the Coordinating Nodes.
   * - GET /resolve/{pid}
     - :func:`CN_read.resolve`
     - Implemented by CNs, returns the nodes (MNs or CNs) known to hold copies
       of the object identified by *<pid>*. The object resolution process is
       intended to provide a simple mechanism for a client to discover from
       which node(s) a particular object may be retrieved, and this information
       is returned as a list of node identifiers. Details about method
       interfaces (i.e. REST URLs) exposed by a particular node can be
       determined by examining the response from the *node* collection. For
       convenience, the :func:`MN_read.get` URL is included in the response as
       is the base URL of the node REST services. Note also that the same
       functionality as *resolve()* can be implemented by retrieving a copy of
       the system metadata for the object and utilizing the node registry to
       discover the base URL from which the client can construct the *get()*
       URL. Resolve is provided for efficiency since the response size is much
       smaller.
   * - POST /reserve
     - :func:`CN_read.reserveIdentifier`
     - Given an optional scope and format, reserves and returns an identifier
       within that scope and format that is unique and will not be used by any
       other sessions. Future calls to :func:`MN_storage.create` and
       :func:`MN_storage.update` that reference this ID must originate from the
       :term:`session` in which the identifier was reserved, otherwise an error
       is raised on those methods.
   * - GET /assertRelation/{pidOfSubject}
     - :func:`CN_read.assertRelation`
     - Tests that the specified relationship between *pidOfSubject* and
       *pidOfObject* exists.
   * - GET /object
     - :func:`CN_read.search`
     - Search the metadata catalog and return identifiers of metadata records
       that match the criteria.
   * - GET /formats
     - :func:`CN_core.listFormats`
     - Returns a list of all object formats registered in the DataONE Object
       Format Vocabulary.
   * - GET /formats/{fmtid}
     - :func:`CN_core.getFormat`
     - Returns the object format registered in the dataONE Object Format
       Vocabulary for the given format identifier.
   * - GET /log
     - :func:`CN_core.getLogRecords`
     - Retrieves consolidated log information for the specified date range
       (inclusive) for the entire DataONE infrastructure
   * - GET /node
     - :func:`CN_core.listNodes`
     - Returns a list of nodes that have been registered with the DataONE
       infrastructure.
   * - PUT /owner/{pid}
     - :func:`CN_auth.setOwner`
     - Changes ownership (RightsHolder) of the specified object to the
       :term:`principal` specified by `userId`
   * - POST /accounts
     - :func:`CN_auth.registerAccount`
     - Create a new :term:`principal` in the DataONE system. Note that there
       should probably be a lot more metadata captured about the new user, and
       there should be a mechanism for specifying the default access control
       rules for the new account.
   * - POST /accounts
     - :func:`CN_auth.updateAccount`
     - Update an existing :term:`principal` in the DataONE system. Note that
       there should probably be a policy for verifying the details that change
       via this method.
   * - POST /accounts/{principal}
     - :func:`CN_auth.verifyAccount`
     - Verify that the Person data associated with this Principal is a true
       representation of the real world person. This service can only be called
       byt users who have an administrative role for the domain of users in
       question.
   * - GET /accounts/{principal}
     - :func:`CN_auth.getPrincipalInfo`
     - Get the information about a Person (their equivalent identities, and the
       Groups to which they belong) or the Group (including members).
   * - GET /accounts
     - :func:`CN_auth.listPrincipals`
     - List the principals, including users, groups, and systems, that match
       search criteria. The list can be restricted to principals whose
       identifier matches certain substrings, and the size of the resultset can
       be paged through.
   * - POST /accounts/map
     - :func:`CN_auth.mapIdentity`
     - Map the two authenticated identities, asserting that they represent the
       same principal. Mapping identities is a two-step process wherein a map
       request is made by a primary Principal and a subsequent (confirmation)
       map request is made by the secondary Principal. This ensures that
       mappings are performed only by those that have authority to do so.
   * - POST /groups/{groupName}
     - :func:`CN_auth.createGroup`
     - Create a group with the given name. Groups are lists of principals that
       allow all members of the group to be referenced by listing solely the
       subject name of the group.  Group names must be unique within the DataONE
       system, and can only be modified by their creator.
   * - PUT /groups/{groupName}
     - :func:`CN_auth.addGroupMembers`
     - Add members to the named group. Group members can be added by the
       original creator of the group, otherwise a NotAuthorized exception is
       thrown.  Group members are provided as a list of principals to be added
       to the group.
   * - DELETE /groups/{groupName}
     - :func:`CN_auth.removeGroupMembers`
     - Remove members to the named group. Group members can be removed by the
       original creator of the group, otherwise a NotAuthorized exception is
       thrown.  Group members are provided as a list of principals to be removed
       from the group.
   * - GET /isAuthorized/{pid}
     - :func:`CN_auth.isAuthorized`
     - Test if the user identified by the provided token has authorization for
       operation on the specified object. .. Note:: Should perhaps add
       convenience methods for "canRead()" and "canWrite()" to verify that a
       user is able to read / write an object. .. Note:: The token and operation
       parameters are not currently encoded in the REST URL, so unclear how they
       should be passed in.
   * - PUT /accessRules/{pid}
     - :func:`CN_auth.setAccess`
     - Sets the access permissions for an object identified by *pid*. .. Note::
       The token and accessPolicy parameters are not currently encoded in the
       REST URL, so unclear how they should be passed in.
   * - POST /notify
     - :func:`CN_storage.setReplicationStatus`
     - Update the replication status of the system metadata, ensuring that the
       change is appropriate for the given state of system metadata.  For
       example, a MN can not change the status to *COMPLETED* unless the CN
       previously requested replication of the object and the replications
       status of the object (as indicated in the system metadata) is set to
       *QUEUED*.
   * - PUT /node/{pid}
     - :func:`CN_register.addNodeCapabilities`
     - 
   * - POST /node
     - :func:`CN_register.register`
     - 
