<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="535px" preserveAspectRatio="none" style="width:999px;height:535px;" version="1.1" viewBox="0 0 999 535" width="999px" zoomAndPan="magnify"><defs><filter height="300%" id="f1o16os5w7iwlt" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="446" x="274.25" y="28.708">Detailed Access Token Authentication Scenarios</text><rect fill="#FFFFFF" filter="url(#f1o16os5w7iwlt)" height="204.9297" style="stroke:#000000;stroke-width:2.0;" width="526" x="10" y="254.2109"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="62" x2="62" y1="91.5469" y2="476.1406"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="338.5" x2="338.5" y1="91.5469" y2="476.1406"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="484" x2="484" y1="91.5469" y2="476.1406"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="696.5" x2="696.5" y1="91.5469" y2="476.1406"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="802.5" x2="802.5" y1="91.5469" y2="476.1406"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="919.5" x2="919.5" y1="91.5469" y2="476.1406"/><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="81" x="20" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="67" x="27" y="59.9482">«MNode»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="45.5" y="76.2451">KNB</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="81" x="20" y="475.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="67" x="27" y="495.1357">«MNode»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="45.5" y="511.4326">KNB</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="112" x="280.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="98" x="287.5" y="59.9482">«Application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="308" y="76.2451">R Client</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="112" x="280.5" y="475.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="98" x="287.5" y="495.1357">«Application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="308" y="511.4326">R Client</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="79" x="443" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="65" x="450" y="59.9482">«CNode»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="461" y="76.2451">Portal</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="79" x="443" y="475.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="65" x="450" y="495.1357">«CNode»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="461" y="511.4326">Portal</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="112" x="638.5" y="39.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="98" x="645.5" y="59.9482">«Application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="654.5" y="76.2451">Web Client</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="112" x="638.5" y="475.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="98" x="645.5" y="495.1357">«Application»</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="80" x="654.5" y="511.4326">Web Client</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="764.5" y="56.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="771.5" y="76.2451">CILogon</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="764.5" y="475.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="58" x="771.5" y="495.1357">CILogon</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="135" x="850.5" y="56.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="857.5" y="76.2451">Identity Provider</text><rect fill="#FEFECE" filter="url(#f1o16os5w7iwlt)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="135" x="850.5" y="475.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="857.5" y="495.1357">Identity Provider</text><polygon fill="#A80036" points="790.5,118.6797,800.5,122.6797,790.5,126.6797,794.5,122.6797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="696.5" x2="796.5" y1="122.6797" y2="122.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="703.5" y="117.6138">Select IdP</text><polygon fill="#A80036" points="707.5,147.8125,697.5,151.8125,707.5,155.8125,703.5,151.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="701.5" x2="801.5" y1="151.8125" y2="151.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="713.5" y="146.7466">IdP Redirect</text><polygon fill="#A80036" points="908,176.9453,918,180.9453,908,184.9453,912,180.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="696.5" x2="914" y1="180.9453" y2="180.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="703.5" y="175.8794">Identity Verification</text><polygon fill="#A80036" points="707.5,206.0781,697.5,210.0781,707.5,214.0781,703.5,210.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="701.5" x2="919" y1="210.0781" y2="210.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="713.5" y="205.0122">CILogon Redirect</text><polygon fill="#A80036" points="495.5,235.2109,485.5,239.2109,495.5,243.2109,491.5,239.2109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="489.5" x2="695.5" y1="239.2109" y2="239.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="501.5" y="234.145">follow redirect to profile page</text><path d="M10,254.2109 L229,254.2109 L229,261.2109 L219,271.2109 L10,271.2109 L10,254.2109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="204.9297" style="stroke:#000000;stroke-width:2.0;" width="526" x="10" y="254.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="25" y="267.2778">Bearer Token Scenario</text><polygon fill="#A80036" points="349.5,288.4766,339.5,292.4766,349.5,296.4766,345.5,292.4766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="343.5" x2="483.5" y1="292.4766" y2="292.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="355.5" y="287.4106">copy access_token</text><polygon fill="#A80036" points="73.5,317.6094,63.5,321.6094,73.5,325.6094,69.5,321.6094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="67.5" x2="337.5" y1="321.6094" y2="321.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="145" x="79.5" y="316.5435">get(access_token, pid)</text><polygon fill="#A80036" points="472.5,346.7422,482.5,350.7422,472.5,354.7422,476.5,350.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="62.5" x2="478.5" y1="350.7422" y2="350.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="69.5" y="345.6763">getPublicKey()</text><polygon fill="#A80036" points="73.5,375.875,63.5,379.875,73.5,383.875,69.5,379.875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="67.5" x2="483.5" y1="379.875" y2="379.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="79.5" y="374.8091">public_key</text><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="104.5" y1="409.0078" y2="409.0078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="104.5" x2="104.5" y1="409.0078" y2="422.0078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="63.5" x2="104.5" y1="422.0078" y2="422.0078"/><polygon fill="#A80036" points="73.5,418.0078,63.5,422.0078,73.5,426.0078,69.5,422.0078" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="262" x="69.5" y="403.9419">validateToken(access_token, public_key)</text><polygon fill="#A80036" points="326.5,447.1406,336.5,451.1406,326.5,455.1406,330.5,451.1406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="62.5" x2="332.5" y1="451.1406" y2="451.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="69.5" y="446.0747">data or NotAuthorized</text><!--MD5=[3307c83ce01483f5432812049a99218e]
@startuml
title Detailed Access Token Authentication Scenarios
participant "KNB" as MN << MNode >>
participant "R Client" as R << Application >>
participant "Portal" as Portal <<CNode>>
participant "Web Client" as Web << Application >>
participant "CILogon" as CI
participant "Identity Provider" as IP

Web->CI: Select IdP
CI- ->Web: IdP Redirect
Web->IP: Identity Verification
IP- ->Web: CILogon Redirect
Web -> Portal: follow redirect to profile page

group Bearer Token Scenario
    Portal->R: copy access_token
    R->MN: get(access_token, pid)
    MN- ->Portal: getPublicKey()
    MN<- -Portal: public_key
    MN->MN: validateToken(access_token, public_key)
    R<-MN: data or NotAuthorized
end
@enduml

PlantUML version 1.2020.21beta3(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>